!function(t,i){"function"==typeof define&&define.amd?define(["$"],i):"object"==typeof exports?module.exports=i():t.Dialog=i(window.Zepto||window.jQuery||$)}(this,function(t){t.fn.Dialog=function(e){var s=[];return t(this).each(function(){var n=new i,o=t.extend({trigger:t(this)},e);n.init(o),s.push(n)}),s},t.Dialog=function(e){if("alert"===e.type){var s=new i,n='<div class="ui-alert-title">'+e.content+"</div>",o="";e.button?("boolean"==typeof e.button&&(e.button="确定"),o='<p class="ui-dialog-action"><button class="ui-alert-submit  js-dialog-close">'+e.button+"</button></p>"):e.timer||(e.timer=3e3),n+=o;var a=t.extend({target:n,animate:!0,showType:"zoomIn",show:!0,mask:!0,className:"ui-alert",afterHide:function(t){this.dispose(),e.callback&&e.callback()}},e);s.init(a),e.timer&&setTimeout(function(){s.dispose(),e.callback&&e.callback()},e.timer),s.touch(s.mask,function(){s.hide(),e.callback&&e.callback()})}if("confirm"===e.type){var l=new i,n='<div class="ui-confirm-title">'+e.content+"</div>",o="";e.buttons||(e.buttons=[{no:"取消"},{yes:"确定"}]);for(var d="",h=0,r=e.buttons.length;h<r;h++){var c=e.buttons[h];c.yes&&(d+='<td align="right"><button class="ui-confirm-submit " data-type="yes">'+c.yes+"</button></td>"),c.no&&(d+='<td align="left"><button class="ui-confirm-no" data-type="no">'+c.no+"</button></td>"),c.close&&(d+='<td><button class="ui-confirm-close js-dialog-close" data-type="close">'+c.close+"</button></td>")}o='<table class="ui-dialog-action"><tr>'+d+"</tr></table>",n=o+n;var g=t.extend({target:n,animate:!0,showType:"zoomIn",show:!0,fixed:!0,mask:!0,className:"",afterHide:function(t){this.dispose()},beforeShow:function(i){l.touch(t(".ui-confirm-submit",i),function(){e.callback&&e.callback.call(l,"yes",i)}),l.touch(t(".ui-confirm-no",i),function(){e.callback&&e.callback.call(l,"no",i)}),l.touch(t(".ui-confirm-close",i),function(){e.callback&&e.callback.call(l,"close",i)})}},e);l.init(g)}},t.alert=function(i,e,s,n,o){var a={},l={zIndex:100,type:"alert"};a="object"==typeof i?t.extend(l,i):t.extend(l,{content:i,button:e,timer:n,callback:s}),t.Dialog(t.extend(a,o))},t.confirm=function(i,e,s,n){var o={},a={zIndex:100,type:"confirm"};o="object"==typeof i?t.extend(a,i):t.extend(a,{content:i,buttons:e,callback:s}),t.Dialog(t.extend(o,n))};var i=function(){var i=Math.random().toString().replace(".","");this.id="dialog_"+i,this.settings={},this.settings.closeTpl=t('<span class="ui-dialog-close js-dialog-close">x</span>'),this.settings.titleTpl=t('<div class="ui-dialog-title"></div>'),this.timer=null,this.showed=!1,this.mask=t()};return i.prototype={init:function(i){this.settings=t.extend({fixed:!1},this.settings,i),this.settings.mask&&(this.mask=t('<div class="ui-dialog-mask"/>'),t("body").append(this.mask)),t("body").append('<div class="ui-dialog" id="'+this.id+'"></div>'),this.dialogContainer=t("#"+this.id);var e=this.settings.zIndex||10;this.dialogContainer.css({zIndex:e}),this.settings.className&&this.dialogContainer.addClass(this.settings.className),this.mask.css({zIndex:e-1}),this.settings.title&&(this.dialogContainer.append(this.settings.titleTpl),this.settings.titleTpl.html(this.settings.title)),this.bindEvent(),this.settings.show&&this.show()},touch:function(i,e){function s(t){return e.call(this,t)}var n;t(i).on("touchend",s),t(i).on("touchmove",function(t){n=!0}).on("touchend",function(t){if(t.preventDefault(),!n){var i=e.call(this,t,"touch");i||(t.preventDefault(),t.stopPropagation())}n=!1})},bindEvent:function(){var i=this;this.settings.trigger&&(t(this.settings.trigger).click(function(){i.show()}),i.touch(t(this.settings.trigger),function(){i.show()})),t(this.dialogContainer).on("click",".js-dialog-close",function(){return i.hide(),!1}),t(document).keydown(function(t){27===t.keyCode&&i.showed&&i.hide()}),t(this.dialogContainer).on("hide",function(){i.hide()})},dispose:function(){this.dialogContainer.remove(),this.mask.remove(),this.timer&&clearInterval(this.timer)},hide:function(){var i=this;i.settings.beforeHide&&i.settings.beforeHide.call(i,i.dialogContainer),this.showed=!1,this.mask.hide(),this.timer&&clearInterval(this.timer),this.settings.animate?"zoomIn"==this.settings.showType?(this.dialogContainer.removeClass("zoomIn").addClass("zoomOut"),setTimeout(function(){i.dialogContainer.hide(),"object"==typeof i.settings.target&&t("body").append(i.dialogContainer.hide()),i.settings.afterHide&&i.settings.afterHide.call(i,i.dialogContainer)},500)):"easingIn"==this.settings.showType&&this.dialogContainer.animate({bottom:-this.dialogContainer.outerHeight()},500,function(){setTimeout(function(){i.dialogContainer.hide(),"object"==typeof i.settings.target&&t("body").append(i.dialogContainer.hide()),i.settings.afterHide&&i.settings.afterHide.call(i,i.dialogContainer)},500)}):(this.dialogContainer.hide(),"object"==typeof this.settings.target&&t("body").append(this.dialogContainer),this.settings.afterHide&&this.settings.afterHide.call(this,this.dialogContainer))},show:function(){"string"==typeof this.settings.target?/^(\.|\#\w+)/gi.test(this.settings.target)?this.dailogContent=t(this.settings.target):this.dailogContent=t("<div>"+this.settings.target+"</div>"):this.dailogContent=this.settings.target,this.mask.show(),this.dailogContent.show(),this.height=this.settings.height||"auto",this.width=this.settings.width||"auto",this.dialogContainer.append(this.dailogContent).show().css({height:this.height,width:this.width}),this.settings.beforeShow&&this.settings.beforeShow.call(this,this.dialogContainer),this.showed=!0,t(this.settings.trigger).blur(),this.setPosition();this.timer&&clearInterval(this.timer),this.settings.fixed,this.settings.animate&&("zoomIn"==this.settings.showType?this.dialogContainer.addClass("zoomIn").removeClass("zoomOut").addClass("animated"):"easingIn"==this.settings.showType&&this.dialogContainer.css("bottom",-this.dialogContainer.outerHeight()).animate({bottom:0},300,function(){}))},setPosition:function(){if(this.showed){var t=this;this.dialogContainer.show(),this.height=this.settings.height,this.width=this.settings.width,isNaN(this.height)&&(this.height=this.dialogContainer.outerHeight&&this.dialogContainer.outerHeight()||this.dialogContainer.height()),isNaN(this.width)&&(this.width=this.dialogContainer.outerWidth&&this.dialogContainer.outerWidth()||this.dialogContainer.width());var i=this.settings.clientHeight||document.documentElement.clientHeight||document.body.clientHeight,e=this.settings.clientWidth||document.documentElement.clientWidth||document.body.clientWidth,s=this.width/2,n=this.height/2,o=0;if("alert"==this.settings.type)var o=e/2-s;var a=0,l=i/2-n;o=Math.floor(Math.max(0,o)),l=Math.floor(Math.max(0,l));var d="absolute";t.settings.fixed&&(d="fixed"),"alert"==this.settings.type?t.dialogContainer.css({position:d,top:l,left:o}):t.dialogContainer.css({position:d,bottom:a,left:o})}}},i}),function(t,i){"function"==typeof define&&define.amd?define(["$","dialog"],i):"function"==typeof define&&define.cmd?define(function(t,e,s){var n=t("$"),o=t("dialog");return i(n,o)}):"object"==typeof exports?module.exports=i():t.MobileSelectArea=i(window.Zepto||window.jQuery||$)}(this,function(t,i){var e=function(){var t=Math.random().toString().replace(".","");this.id="scroller_"+t,this.scroller,this.data,this.index=0,this.value=[0,0,0],this.oldvalue,this.oldtext=[],this.text=["","",""],this.level=3,this.mtop=35,this.separator=" "};return e.prototype={init:function(i){this.settings=t.extend({eventName:"touchstart"},i),this.trigger=t(this.settings.trigger),void 0==this.settings["default"]?this["default"]=1:this["default"]=this.settings["default"],level=parseInt(this.settings.level),this.level=level>0?level:3,this.trigger.attr("readonly","readonly"),this.value=this.settings.value&&this.settings.value.split(",")||[0,0,0],this.text=this.settings.text&&this.settings.text.split(" ")||["","",""],this.oldvalue=this.value.concat([]),this.oldtext=this.text.concat([]),this.clientHeight=document.documentElement.clientHeight||document.body.clientHeight,this.clientWidth=document.documentElement.clientWidth||document.body.clientWidth,this.bindEvent()},getData:function(){var i=this,e=t.Deferred();return"object"==typeof this.settings.data?(this.data=this.settings.data,e.resolve()):t.ajax({dataType:"json",cache:!0,url:this.settings.data,type:"GET",success:function(t){i.data=t.data,e.resolve()},accepts:{json:"application/json, text/javascript, */*; q=0.01"}}),e},bindEvent:function(){var i=this;t(this.trigger).on(i.settings.eventName,function(e){t(":focus").blur();for(var s="",n=100/i.level,o=0;o<i.level;o++)s+='<div style="width:'+n+'%;"></div>';t.confirm('<div class="ui-scroller-mask"><div id="'+i.id+'" class="ui-scroller">'+s+"<p></p></div></div>",null,function(t,e){"yes"==t&&i.submit(),"no"==t&&i.cancel(),this.dispose()},{showType:i.settings.showType,width:"100%"}),i.scroller=t("#"+i.id),i.getData().done(function(){i.format()});var a=0,l=0;return i.scroller.children().bind("touchstart",function(t){a=(t.changedTouches||t.originalEvent.changedTouches)[0].pageY}),i.scroller.children().bind("touchmove",function(i){l=(i.changedTouches||i.originalEvent.changedTouches)[0].pageY;var e=l-a,s=t(i.target).parent();if("DL"==s[0].nodeName){var n=parseInt(s.css("top")||0)+e;return s.css("top",n),a=l,!1}}),i.scroller.children().bind("touchend",function(e){l=(e.changedTouches||e.originalEvent.changedTouches)[0].pageY;var s=l-a,n=t(e.target).parent(),o=n.parent();if("DL"==n[0].nodeName){var d=t(n.parent()).index(),h=parseInt(n.css("top")||0)+s,r=t(n).children().get(0);i.mtop=parseFloat(window.getComputedStyle(r)["padding-top"])+parseFloat(window.getComputedStyle(r).height)+parseFloat(window.getComputedStyle(r)["padding-bottom"]),h>i.mtop&&(h=i.mtop),h<-t(n).height()+80&&(h=-t(n).height()+80);var c=h/i.mtop,g=Math.round(c),u=Math.abs(g)+1;1==g?u=0:u>=n.children().length&&(u=n.children().length-1),i.value[d]=t(n.children().get(u)).attr("ref"),0==i.value[d]?i.text[d]="":i.text[d]=t(n.children().get(u)).html();for(var f=i.level-1;f>d;f--)i.value[f]=0,i.text[f]="";return t(n.children().get(u)).hasClass("focus")||i.format(),n=o.children("dl"),t(n.children().get(u)).addClass("focus").siblings().removeClass("focus"),n.css("top",g*i.mtop),!1}}),!1})},format:function(){var t=this;t.scroller.children();this.f(this.data),console.log(t.text)},f:function(i){var e=this,s=i;s||(s=[]);var n=e.scroller.children();t(n[e.index]).html("<dl><dd>啊</dd></dl>");var o=t(n[e.index]).children().get(0);e.mtop=parseFloat(window.getComputedStyle(o)["padding-top"])+parseFloat(window.getComputedStyle(o).height)+parseFloat(window.getComputedStyle(o)["padding-bottom"]);var a,l='<dl><dd ref="0">——</dd>',d=0,h=e.mtop;if(0!==e.index&&"0"==e.value[e.index-1]&&0==this["default"])l='<dl><dd ref="0" class="focus">——</dd>',e.value[e.index]=0,e.text[e.index]="",d=0;else{if("0"==e.value[e.index]&&(l='<dl><dd ref="0" class="focus">——</dd>',d=0),s.length>0&&1==this["default"]){l="<dl>";var r=s[0].pid||0,c=s[0].id||0;d=s[0].id,a=s[0].child;var g="";e.value[this.index]||(e.value[this.index]=c,e.text[this.index]=s[0].name),e.value[this.index]==c&&(g="focus"),l+='<dd pid="'+r+'" class="'+g+'" ref="'+c+'">'+s[0].name+"</dd>"}for(var u=e["default"],f=s.length;u<f;u++){var r=s[u].pid||0,c=s[u].id||0,g="";e.value[e.index]==c&&(g="focus",d=c,a=s[u].child,h=e.mtop*-(u-e["default"])),l+='<dd pid="'+r+'" class="'+g+'" ref="'+c+'">'+s[u].name+"</dd>"}}l+="</dl>";var p=t(l);return p.css("top",h),t(n[e.index]).html(p),e.index++,e.index>e.level-1?void(e.index=0):void e.f(a)},submit:function(){this.oldvalue=this.value.concat([]),this.oldtext=this.text.concat([]),1==this.trigger[0].nodeType&&("INPUT"==this.trigger[0].tagName||"TEXTAREA"==this.trigger[0].tagName?this.trigger.val(this.text.join(this.separator)):this.trigger.text(this.text.join(this.separator)),this.trigger.attr("data-value",this.value.join(",")).addClass("has-val")),this.trigger.next(":hidden").val(this.value.join(",")),this.settings.callback&&this.settings.callback.call(this,this.scroller,this.text,this.value)},cancel:function(){this.value=this.oldvalue.concat([]),this.text=this.oldtext.concat([])}},e});